#SingleInstance force
#EscapeChar \
SetTitleMatchMode 3
#IfWinActive Path of Exile
{

;====== DONT TOUCH / reading variables from external file ======
; reader,   variable name, file to read, [section name],  read key
IniRead, custommessage1, whisperconfig.ini, config, Message1
IniRead, custommessage2, whisperconfig.ini, config, Message2
IniRead, custommessage3, whisperconfig.ini, config, Message3
IniRead, custommessage4, whisperconfig.ini, config, Message4
IniRead, custommessage5, whisperconfig.ini, config, Message5
IniRead, partymessage1, whisperconfig.ini, config, Party1
IniRead, partymessage2, whisperconfig.ini, config, Party2
IniRead, partymessage3, whisperconfig.ini, config, Party3
IniRead, partymessage4, whisperconfig.ini, config, Party4
IniRead, partymessage5, whisperconfig.ini, config, Party5
IniRead, partymessage6, whisperconfig.ini, config, Party6
IniRead, partymessage7, whisperconfig.ini, config, Party7
IniRead, partymessage8, whisperconfig.ini, config, Party8
IniRead, partymessage9, whisperconfig.ini, config, Party9
IniRead, logout_X_Coordinate, whisperconfig.ini, config, X_Coordinate
IniRead, logout_Y_Coordinate, whisperconfig.ini, config, Y_Coordinate
IniRead, lagsleep, whisperconfig.ini, config, GameLagCompensation

IniRead, macroparty1, macroconfig.ini, macro, party1
IniRead, macroparty2, macroconfig.ini, macro, party2
IniRead, macroparty3, macroconfig.ini, macro, party3
IniRead, macroparty4, macroconfig.ini, macro, party4
IniRead, macroparty5, macroconfig.ini, macro, party5
IniRead, macroparty6, macroconfig.ini, macro, party6
IniRead, macroparty7, macroconfig.ini, macro, party7
IniRead, macroparty8, macroconfig.ini, macro, party8
IniRead, macroparty9, macroconfig.ini, macro, party9
IniRead, macromessage1, macroconfig.ini, macro, message1
IniRead, macromessage2, macroconfig.ini, macro, message2
IniRead, macromessage3, macroconfig.ini, macro, message3
IniRead, macromessage4, macroconfig.ini, macro, message4
IniRead, macromessage5, macroconfig.ini, macro, message5
IniRead, macrologout, macroconfig.ini, macro, logout
IniRead, macrohideout, macroconfig.ini, macro, hideout
IniRead, macroremaining, macroconfig.ini, macro, remaining
IniRead, macrocursor, macroconfig.ini, macro, cursor
IniRead, macroresync, macroconfig.ini, macro, resync
IniRead, macroinvite, macroconfig.ini, macro, invite
IniRead, macrostarttrade, macroconfig.ini, macro, starttrade
IniRead, macrowhois, macroconfig.ini, macro, whois
IniRead, macrohelp, macroconfig.ini, macro, help

Hotkey, %macroparty1%, executeparty1
Hotkey, %macroparty2%, executeparty2
Hotkey, %macroparty3%, executeparty3
Hotkey, %macroparty4%, executeparty4
Hotkey, %macroparty5%, executeparty5
Hotkey, %macroparty6%, executeparty6
Hotkey, %macroparty7%, executeparty7
Hotkey, %macroparty8%, executeparty8
Hotkey, %macroparty9%, executeparty9
Hotkey, %macromessage1%, executemessage1
Hotkey, %macromessage2%, executemessage2
Hotkey, %macromessage3%, executemessage3
Hotkey, %macromessage4%, executemessage4
Hotkey, %macromessage5%, executemessage5
Hotkey, %macrologout%, executelogout
Hotkey, %macrocursor%, executecursor
Hotkey, %macroresync%, executeresync
Hotkey, %macroremaining%, executeremaining
Hotkey, %macrowhois%, executewhois
Hotkey, %macroinvite%, executeinvite
Hotkey, %macrostarttrade%, executestarttrade
Hotkey, %macrohideout%, executehideout
Hotkey, %macrohelp%, executehelp
return

;^ is CTRL button, 
;! is Left ALT and 
;+ is Left Shift. 

;==========================================
;====== ALL REPLY WHISPER MESSAGES START HERE ======	
;==========================================

;====== WHISPER MESSAGE 1 ======
executemessage1:
	BlockInput On
	SendInput ^{Enter}%custommessage1%{Enter}
	BlockInput Off
	return	
;====== WHISPER MESSAGE 2 ======
executemessage2:
	BlockInput On
	SendInput ^{Enter}%custommessage2%{Enter}
	BlockInput Off
	return
;====== WHISPER MESSAGE 3 ======
executemessage3:
	BlockInput On
	SendInput ^{Enter}%custommessage3%{Enter}
	BlockInput Off
	return
;====== WHISPER MESSAGE 4 ======
executemessage4:
	BlockInput On
	SendInput ^{Enter}%custommessage4%{Enter}
	BlockInput Off
	return
;====== WHISPER MESSAGE 5 ======
executemessage5:
	BlockInput On
	SendInput ^{Enter}%custommessage5%{Enter}
	BlockInput Off
	return
;====== INVITE WHISPERER ======
executeinvite:
	BlockInput On
	SendInput ^{Enter}{Home}{Delete}/invite {Enter}{enter}{up}{up}{escape}
	BlockInput Off
	return
;====== TRADE WHISPERER ======
executestarttrade:
	BlockInput On
	SendInput ^{Enter}{Home}{Delete}/tradewith {Enter}{enter}{up}{up}{escape}
	BlockInput Off
	return
;====== WHOIS WHISPERER ======
executewhois:
	BlockInput On
	SendInput ^{Enter}{Home}{Delete}/whois {Enter}{enter}{up}{up}{escape}
	BlockInput Off
	return
;====================================
;====== ALL PARTY MESSAGES START HERE ======	
;====================================

;====== PARTY MESSAGE 1 ======
executeparty1:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage1%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE2 ======
executeparty2:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage2%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE 3 ======
executeparty3:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage3%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE 4 ======
executeparty4:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage4%
	SendInput {Enter}
	BlockInput Off
	return		
;====== PARTY MESSAGE 5 ======
executeparty5:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage5%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE 6 ======
executeparty6:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage6%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE 7 ======
executeparty7:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage7%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE 8 ======
executeparty8:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage8%
	SendInput {Enter}
	BlockInput Off
	return	
;====== PARTY MESSAGE 9 ======
executeparty9:
	BlockInput On
	SendInput {Enter}
	Sendraw \%
	SendInput %partymessage9%
	SendInput {Enter}
	BlockInput Off
	return	
;================================================
;====== ALL NON MESSAGE MACROS START HERE =======	
;================================================
	
;====== OUT OF SYNC MACRO ======	
executeresync:
	BlockInput On
	SendInput {Enter}/oos{Enter}{enter}{up}{up}{escape}
	BlockInput Off
	return
;====== LOG OUT FAST ======
executelogout:
	BlockInput, On
	SendInput {Escape}
	Sleep %lagsleep%
    MouseClick, left, %logout_X_Coordinate%, %logout_Y_Coordinate%, 2, 0
	BlockInput, Off
	return
;====== GET REMAINING MONSTERS ======
executehideout:
	BlockInput On
	SendInput {Enter}/hideout{Enter}{enter}{up}{up}{escape}
	BlockInput Off
	return
;====== GO TO HIDEOUT ======
executeremaining:
	BlockInput On
	SendInput {Enter}/remaining{Enter}{enter}{up}{up}{escape}
	BlockInput Off
	return
;====== GET CURSOR POSITION ======
executecursor:
	MouseGetPos, xpos, ypos 
	Msgbox, The cursor is at X[%xpos%] Y[%ypos%] 
	return
;====== CLOSES MACRO PROGRAM ======
F12::
	ExitApp
	return	
;====== SHOW HELP ======
executehelp:
	if HelpInterfaceHasBeenActive > 0  
	{
	Gui, Show
	}
	else
	{
    HelpInterfaceHasBeenActive++
	Gui, -DPIscale
	Gui, Add, Picture, x0 y0 w760 h365 , bg.png
	Gui, Add, Picture, x605 y20 BackGroundTrans, logo.png
	Gui, Add, Edit, x615 y250 w125 h20 vUserMacroInput, initial text
	Gui, Add, Edit, x20 y20 w385 h70 vUserInput, Press a keybinding to see what it does. In many cases you can change both what the macro does and the hotkey/keybind. \n\n Enjoy!
	Gui, Font, S9 CDefault, Verdana ;sets font size of all following items
	Gui, Add, Text, x22 y105 w125 h20 BackGroundTrans, Whisper Macros
	Gui, Add, Text, x152 y105 w125 h20 BackGroundTrans, Party Macros
	Gui, Add, Text, x22 y252 w125 h20 BackGroundTrans, Utility Macros
	Gui, Add, Text, x615 y230 w125 h20 BackGroundTrans, Change Hotkey
	Gui, Add, Text, x615 y150 w125 h20 BackGroundTrans, Change Config
	Gui, Add, Text, x282 y105 w125 h20 BackGroundTrans, Normal Macros
	Gui, Font, S7 CDefault, Verdana ;sets font size of all following items
	Gui, Add, Text, x420 y20 w165 h335 BackGroundTrans, 1. Click on a macro to edit. \n\n2. Use large input field to change what macro does.\n\n 3. hit "SAVE CONFIG" to the right.\n\n 4. Use small input field on the right to edit macro shortcut. \n\n5. Hit "SAVE HOTKEY" after. \n\nUse these keys to define the hotkeys.\n\n^ = CTRL\n! = ALT\n+ = SHIFT 
	Gui, Font, S7 CDefault, Verdana ;sets font size of all following items
	Gui, Add, Button, x20 y125 w125 h20 gWhisper1, %macromessage1%
	Gui, Add, Button, x20 y150 w125 h20 gWhisper2, %macromessage2%
	Gui, Add, Button, x20 y175 w125 h20 gWhisper3, %macromessage3%
	Gui, Add, Button, x20 y200 w125 h20 gWhisper4, %macromessage4%
	Gui, Add, Button, x20 y225 w125 h20 gWhisper5, %macromessage5%	
	Gui, Font, S7 CDefault, Verdana ;sets font size of all following items
	Gui, Add, Button, x20 y275 w125 h20 gUtility1, %macroinvite%
	Gui, Add, Button, x20 y300 w125 h20 gUtility2, %macrostarttrade%
	Gui, Add, Button, x20 y325 w125 h20 gUtility3, %macrowhois%
	Gui, Add, Button, x150 y125 w125 h20 gParty1, %macroparty1%
	Gui, Add, Button, x150 y150 w125 h20 gParty2, %macroparty2%
	Gui, Add, Button, x150 y175 w125 h20 gParty3, %macroparty3%
	Gui, Add, Button, x150 y200 w125 h20 gParty4, %macroparty4%
	Gui, Add, Button, x150 y225 w125 h20 gParty5, %macroparty5%
	Gui, Add, Button, x150 y250 w125 h20 gParty6, %macroparty6%
	Gui, Add, Button, x150 y275 w125 h20 gParty7, %macroparty7%
	Gui, Add, Button, x150 y300 w125 h20 gParty8, %macroparty8%
	Gui, Add, Button, x150 y325 w125 h20 gParty9, %macroparty9%
	Gui, Add, Button, x280 y125 w125 h20 gCommon1, %macroresync%
	Gui, Add, Button, x280 y150 w125 h20 gCommon2, %macrohideout%
	Gui, Add, Button, x280 y175 w125 h20 gCommon4, %macroremaining%
	Gui, Add, Button, x280 y200 w125 h20 gCommon3, %macrocursor%
	Gui, Add, Button, x280 y225 w125 h20 gCommon5, X-coord: %macrologout%
	Gui, Add, Button, x280 y250 w125 h20 gCommon6, Y-coord: %macrologout%
	Gui, Add, Button, x280 y275 w125 h20 ghelp, %macrohelp%
	Gui, Add, Button, x615 y275 w125 gWriteHotkey, Save HOTKEY
	Gui, Font, S7 CDefault Bold, Verdana ;sets font size of all following items
	Gui, Add, Button, x615 y175 w125 h45 gWriteConfig, SAVE CONFIG
	Gui, Add, Button, x615 y300 w125 h45 gQuithelp, CLOSE HELP
	Gui, Font, S7 CDefault, Verdana ;sets font size of all following items
	Gui, +AlwaysOnTop
	Gui, -border
	Gui, Show, x20 y20 h365 w760, Path of Macros
	}
Return

;labels start here
WriteConfig:
	guiControlGet, UserInput
	MsgBox input is: %UserInput% save to this field: %activeconfig%
	if activeconfig = NoConfig  
	{
	MsgBox This macro can not be configured / you can only change the hotkey. 	NOTHING SAVED!!!
	}
	else
	{
	IniWrite, %UserInput%, whisperconfig.ini, config, %activeconfig%
	IniRead,InfoTxt, whisperconfig.ini, config, %activeconfig%
	MsgBox SAVED: %InfoTxt%	
	}
	return
WriteHotkey:
	guiControlGet, UserMacroInput
	IniWrite, %UserMacroInput%, macroconfig.ini, macro, %activemacro%
	IniRead,MacroInfoTxt, macroconfig.ini, macro, %activemacro%
	MsgBox SAVED: %MacroInfoTxt%
	return
Quithelp:
	Gui, Submit, Hide
	return  
Help:
	Gui, Submit, NoHide
	helpmessage := "NO CONFIG: You can not change any settings in the help section."
	activemacro = help
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrohelp%	
    guiControlGet, UserInput
    guiControl,,UserInput, %helpmessage%    ;now set the url back to the control
	return  
Whisper1: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Message1
	activemacro = message1
    activeconfig = Message1
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macromessage1%	
    guiControlGet, UserInput
    guiControl,,UserInput, %custommessage1%    ;now set the url back to the control
	return  
Whisper2: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Message2
	activemacro = message2
    activeconfig = Message2
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macromessage2%	
    guiControlGet, UserInput
    guiControl,,UserInput, %custommessage2%    ;now set the url back to the control
	return  
Whisper3: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Message3
	activemacro = message3
    activeconfig = Message3
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macromessage3%
    guiControlGet, UserInput
    guiControl,,UserInput, %custommessage3%    ;now set the url back to the control
	return  
Whisper4: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Message4
	activemacro = message4
    activeconfig = Message4
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macromessage4%
    guiControlGet, UserInput
    guiControl,,UserInput, %custommessage4%    ;now set the url back to the control
	return  
Whisper5:  
    Gui, Submit, NoHide
		IniRead, custommessage1, whisperconfig.ini, config, Message5
	activemacro = message5
    activeconfig = Message5
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macromessage5%
    guiControlGet, UserInput
    guiControl,,UserInput, %custommessage5%    ;now set the url back to the control
	return  
Utility1: 
    Gui, Submit, NoHide
	invitemessage := "NO CONFIG: This macro invites the last person that whispered you." 
	activemacro = invite
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroinvite%
    guiControlGet, UserInput
    guiControl,,UserInput, %invitemessage%    ;now set the url back to the control
	return 
Utility2: 
    Gui, Submit, NoHide
	starttrademessage := "NO CONFIG: This macro starts a trade with the last person that whispered you provided the person is in the same zone as you." 
	activemacro = starttrade
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrostarttrade%
    guiControlGet, UserInput
    guiControl,,UserInput, %starttrademessage%    ;now set the url back to the control
	return 
Utility3: 
    Gui, Submit, NoHide
	whoismessage := "NO CONFIG: This macro performs a whois command on the last person that whispered you." 
	activemacro = whois
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrowhois%
    guiControlGet, UserInput
    guiControl,,UserInput, %whoismessage%    ;now set the url back to the control
	return 
Party1: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party1
	activemacro = party1
    activeconfig = Party1
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty1%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage1%    ;now set the url back to the control
	return 
Party2: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party2
	activemacro = party2
    activeconfig = Party2
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty2%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage2%    ;now set the url back to the control
	return 
Party3: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party3
	activemacro = party3
    activeconfig = Party3
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty3%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage3%    ;now set the url back to the control
	return 
Party4: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party4
	activemacro = party4
    activeconfig = Party4
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty4%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage4%    ;now set the url back to the control
	return 
Party5: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party5
	activemacro = party5
    activeconfig = Party5
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty5%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage5%    ;now set the url back to the control
	return 
Party6: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party6
	activemacro = party6
    activeconfig = Party6
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty6%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage6%    ;now set the url back to the control
	return 
Party7: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party7
	activemacro = party7
    activeconfig = Party7
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty7%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage7%    ;now set the url back to the control
	return 
Party8: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party8
	activemacro = party8
    activeconfig = Party8
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty8%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage8%    ;now set the url back to the control
	return 
Party9: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Party9
	activemacro = party9
    activeconfig = Party9
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroparty9%
    guiControlGet, UserInput
    guiControl,,UserInput, %partymessage9%    ;now set the url back to the control
	return
Common1: 
    Gui, Submit, NoHide
	oosmessage := "NO CONFIG: This macro performs a resync with the server." 
	activemacro = resync
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroresync%
    guiControlGet, UserInput
    guiControl,,UserInput, %oosmessage%    ;now set the url back to the control
	return
Common2: 
    Gui, Submit, NoHide
	hideoutmessage := "NO CONFIG: This macro moves you to hideout from town." 
	activemacro = hideout
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrohideout%
    guiControlGet, UserInput
    guiControl,,UserInput, %hideoutmessage%    ;now set the url back to the control
	return
Common3: 
    Gui, Submit, NoHide
	cursormessage := "NO CONFIG: This macro gives you the x and y coordinates in a messagebox / you need these to set up the logout macro." 
	activemacro = cursor
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrocursor%
    guiControlGet, UserInput
    guiControl,,UserInput, %cursormessage%    ;now set the url back to the control
	return
Common4: 
    Gui, Submit, NoHide
	remainingmessage := "NO CONFIG: This macro gives you remaining monsters."
	activemacro = remaining
    activeconfig = NoConfig
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macroremaining%
    guiControlGet, UserInput
    guiControl,,UserInput, %remainingmessage%    ;now set the url back to the control
	return
Common5: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, X_Coordinate
	activemacro = logout
    activeconfig = X_Coordinate
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrologout%
    guiControlGet, UserInput
    guiControl,,UserInput, %logout_X_Coordinate%    ;now set the url back to the control
	return
Common6: 
    Gui, Submit, NoHide
	IniRead, custommessage1, whisperconfig.ini, config, Y_Coordinate
	activemacro = logout
    activeconfig = Y_Coordinate
	guiControlGet, UserMacroInput
	guiControl,,UserMacroInput, %macrologout%
    guiControlGet, UserInput
    guiControl,,UserInput, %logout_Y_Coordinate%    ;now set the url back to the control
	return
}
