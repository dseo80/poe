
#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
; #Warn  ; Enable warnings to assist with detecting common errors.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.
#SingleInstance FORCE
Menu, tray, Icon, data\poe-bw.ico

Run Poe_Helper.exe, , , PoePID1
Run PoE_Item\POE_ItemInfo.exe, , , PoePID2
Run PoE_Item\POE_ItemLookup.exe, , , PoePID3
Run PoE_ck.exe, , , PoePID5
Run PoE_macros.exe, , , PoePID6
;Run PoeHud\PoeHUD.exe, C:\Users\Seohyun\Desktop\POE\PoeHud, , PoePID4
Process, priority, %PoePID1%, High

OnExit, ExitSub

F10::JoinChannels() ; Assign F2 to execute the oos command


/* 
macros is taking care of this part
F1::Hideout() ; Assign F1 to /hideout

F2::RemainingCommand() ; Assign F3 to execute the remaining command



F4::Logout() ; Assign F4 to fast logout using cports.

;F9::Tradespam() ; Assign F9 to Tradespam
;F10::CheckItemLevel() ; Assign F10 to Check item level
*/

;Switches Right and Middle Button Functions (so you dont turn off your auras)
#IfWinActive Path of Exile ahk_class Direct3DWindowClass
$RButton::MButton
$MButton::RButton

Q::Send +Q

/* 
commented out

#IfWinActive Path of Exile ahk_class Direct3DWindowClass
;changes behavior of  left click to control+leftclick
Lbutton::
Send ^{Click down}
KeyWait Lbutton
Send ^{Click up}
Return

;incase we need to use regular click control button reverts it back
^Lbutton::Send {Click}

;for one handed playing with mouse
Wheelup::Send Q
Wheeldown::Send T

*/


Logout(){
	Run, cports.exe /close * * * * PathofExile.exe
}

 
Hideout(){
        BlockInput On
        Send {Enter}
        Sleep 25
        Send /hideout
        Send {Enter}
        Sleep, 25
        BlockInput Off
        return
}


RemainingCommand(){
        BlockInput On
        Send {Enter}
        Sleep 25
        Send /remaining
        Send {Enter}
		Sleep 25
        BlockInput Off
        return
}


 
JoinChannels(){
        BlockInput On
        Send {Enter}
        Sleep 25
        Send /trade 1
        Send {Enter}
		Sleep 25
		Send {Enter}
		Sleep 25
		Send /global 820
        Send {Enter}
		Sleep 25
        BlockInput Off
        return
}

/*
 
CheckItemLevel(){
        BlockInput On
        Send {LButton}
        Send {Enter}
        Sleep 50
        Send /itemlevel
        Send {Enter}
        Sleep 75
        Send {LButton}
        BlockInput Off
        return
}

Tradespam() {
TradeChannel:=1
		  Loop 8
			   {
			   SetKeyDelay, 20, 20
                  ControlSend,,{NumpadEnter}, Path of Exile ahk_class Direct3DWindowClass
                  sleep 50
				  ControlSendRaw,,`/trade %TradeChannel%, Path of Exile ahk_class Direct3DWindowClass
                  sleep 50
				  ControlSend,,{NumpadEnter}, Path of Exile ahk_class Direct3DWindowClass
				  Sleep 1500
				  ControlSend,,{NumpadEnter}{Up 2}{NumpadEnter}, Path of Exile ahk_class Direct3DWindowClass
				  Sleep 2000
				  TradeChannel++
				  SetKeyDelay, 0, 0
               }
			    SetKeyDelay, 20, 20
				ControlSend,,{NumpadEnter}, Path of Exile ahk_class Direct3DWindowClass
                ControlSendRaw,,`/trade 1, Path of Exile ahk_class Direct3DWindowClass
                ControlSend,,{NumpadEnter}, Path of Exile ahk_class Direct3DWindowClass
				SetKeyDelay, 0, 0
}

*/


ExitSub:
;if A_ExitReason not in Logoff,Shutdown  ; Avoid spaces around the comma in this line.
{
	Process, close, %PoePID2%
	Process, close, %PoePID3%
	Process, close, %PoePID5%
	Process, close, %PoePID6%
	;Process, close, %PoePID4%
}
ExitApp
